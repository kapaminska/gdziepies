---
import Layout from '../../../layouts/Layout.astro';
import { EditAnnouncementGuard } from '../../../components/announcements/EditAnnouncementGuard';
import { getSupabaseConfig } from '@/lib/supabase-config';

export const prerender = false;

const { id } = Astro.params;

if (!id) {
  return Astro.redirect('/moje-konto');
}

// Pass Supabase config to client component
const { url: supabaseUrl, key: supabaseKey } = getSupabaseConfig();
---

<Layout title="Edytuj ogÅ‚oszenie">
  <main class="container mx-auto px-4 py-8">
    <script define:vars={{ supabaseUrl, supabaseKey }}>
      // Inject Supabase config into window for client-side access
      window.__SUPABASE_URL__ = supabaseUrl;
      window.__SUPABASE_KEY__ = supabaseKey;
    </script>
    <EditAnnouncementGuard
      client:load
      announcementId={id}
      supabaseUrl={supabaseUrl}
      supabaseKey={supabaseKey}
    />
  </main>
</Layout>

